# QuickVariants

## Code for paper "Fast and Accurate Variant Identification Tool for Sequencing-Based Studies"

QuickVariants is a fast and accurate variant identification tool, designed to summarize allele information from read alignments without discarding or filtering the data.

### Usage:

```
java -Xms10g -Xmx10g -jar quick-variants.jar [--out-vcf <out.vcf>] [--out-mutations <out.txt>] --reference <ref.fasta> --in-sam <input.sam> --num-threads num_threads [options]
```

This command converts a SAM file to other formats, most notably .vcf.

#### INPUT:
- `--reference <file>`: The reference to use. Should be in .fasta/.fa/.fna or .fastq/.fq format or a .gz of one of those formats.

#### OUTPUT FORMATS:
Summary by reference position, mutation, genome, and raw output are possible.
- Options for output files, mutation counts, exclusion of non-mutations, and more.

**Summary by reference position**:

- `--out-vcf <file>` output file to generate containing a description of mutation counts by position
- `--vcf-exclude-non-mutations` if set, the output vcf file will exclude positions where no mutations were detected
- `--distinguish-query-ends <fraction>` (default 0.1) In the output vcf file, we separately display which queries aligned at each position with <fraction> of the end of the query and which didn't.

**Summary by mutation**

- `--out-mutations <file>` output file to generate listing the mutations of the queries compared to the reference genome

- `--distinguish-query-ends <fraction>` (default 0.1) When detecting indels, only consider the middle <fraction> of each query

- `--snp-threshold <min total depth> <min supporting depth fraction>` (default 5, 0.9)
    The minimum total depth and minimum supporting depth fraction required at a position to report it as a point mutation

- `--indel-start-threshold <min total depth> <min supporting depth fraction>` (default 1, 0.8)
    The minimum total (middle) depth and minimum supporting depth fraction required at a position to report it as the start of an insertion or deletion

- `--indel-continue-threshold <min total depth> <min supporting depth fraction>` (default 1, 0.7)
    The minimum total (middle) depth and minimum supporting depth fraction required at a position to report it as a continuation of an insertion or deletion
- `--indel-threshold <min total depth> <min supporting depth fraction>`
    Alias for --indel-start-threshold <min total depth> <min supporting depth frequency> and --indel-continue-threshold <min total depth> <min supporting depth frequency>

**Summary by genome**

- `--out-refs-map-count <file>` the output file to summarize the number of reads mapped to each combination of references

**Raw output**

- `--out-sam <file>` the output file in SAM format

- `--out-unaligned <file>` output file containing unaligned reads. Must have a .fasta or .fastq extension

- `--no-output` if no output is requested, skip writing output rather than throwing an error

#### Debugging

- `-v, --verbose` output diagnostic information

- `-vv` more diagnostic information

- `--verbosity-auto` set verbosity flags dynamically and automatically based on the data and alignment

Multiple output formats may be specified during a single run; for example:

- `--out-sam` out.sam --out-unaligned out.fastq

#### OTHER:

- `--num-threads <count>` number of threads to use at once for processing. Higher values will run more quickly on a system that has that many CPUs available.

### Additional Scripts and Models
The `benchmark_scripts` folder contains code used to construct the benchmark dataset, filter SNPs and indels in VCF files, and analyze VCF files.

- `SNP_model.py`: Insert in silico mutations and indels randomly into reference genomes, and generate alignment code.
- `SNPfilter.py`: Filter SNPs in VCF files generated by QuickVariants and bcftools.
- `Indelfiter.py`: Filter indels in VCF files generated by QuickVariants and bcftools, and summarize the number of false positives and false negatives for each dataset.
- `SNP_model_compare.py`: Summarize the number of false positive and false negative SNPs for each dataset.
- `VCFAnalysis.ipynb`: Code to analyze VCF files and visualize results in the samtovcf folder.
